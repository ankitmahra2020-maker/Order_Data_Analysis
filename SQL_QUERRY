--select* from df_orders;
select top 10 product_id ,sum(sale_price) as sales
from df_orders
group by product_id
order by sales desc;


GO







-- top revenues in each region
WITH VT as(
select region,product_id ,sum(sale_price) as sales
from df_orders
group by region,product_id)
select * from(
select * 
,ROW_NUMBER() over(partition by region order by sales desc) as rn
from VT) a
where rn<=5;



--month over month growth
with vt as
(select year(order_date) as order_year,month(order_date) as order_month,sum(sale_price) as sales
from df_orders
group by year(order_date),month(order_date))
select order_month,
  sum(case when order_year=2022 then sales else 0 end)  as sales_2022,
  sum(case when order_year=2023 then sales else 0 end)  as sales_2023
 from vt
 group by order_month
 order by order_month

